{
  "manifest_version": 3,
  "name": "Microsoft Planner Exporter",
  "version": "1.5",
  "description": "Export tasks from Microsoft Planner and Microsoft To Do to JSON/CSV/Text. Add tasks directly from the extension.",
  "permissions": [
    "activeTab",
    "storage",
    "alarms",
    "downloads"
  ],
  "host_permissions": [
    "https://graph.microsoft.com/*",
    "https://planner.cloud.microsoft/*",
    "https://tasks.office.com/*",
    "https://to-do.office.com/*",
    "https://substrate.office.com/*",
    "https://project.microsoft.com/*",
    "https://*.project.microsoft.com/*"
  ],
  "action": {
    "default_popup": "popup.html"
  },
  "content_scripts": [
    {
      "matches": [
        "https://planner.cloud.microsoft/*",
        "https://tasks.office.com/*",
        "https://to-do.office.com/*"
      ],
      "js": ["content.js"],
      "run_at": "document_start",
      "all_frames": true
    }
  ],
  "background": {
    "service_worker": "background.js"
  },
  "web_accessible_resources": [
    {
      "resources": [
        "contextBridge.js",
        "fetchOverride.js",
        "todoPageApi.js",
        "results.html",
        "results.js",
        "results.css",
        "import.html",
        "import.js",
        "import.css",
        "src/modules/*.js"
      ],
      "matches": ["<all_urls>"]
    }
  ]
}

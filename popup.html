<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Planner Exporter</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Planner Exporter</h1>
      <div id="status" class="status"></div>
    </header>

    <section id="context-info" class="section">
      <div class="info-row">
        <span class="label">Plan:</span>
        <span id="plan-name" class="value">-</span>
      </div>
      <div class="info-row">
        <span class="label">Type:</span>
        <span id="plan-type" class="value">-</span>
      </div>
      <div class="info-row">
        <span class="label">Token:</span>
        <span id="token-status" class="value">-</span>
      </div>
      <div class="info-row">
        <span class="label">API Access:</span>
        <span id="api-status" class="value">-</span>
      </div>
    </section>

    <section id="export-section" class="section">
      <h2>Export Tasks</h2>
      <div class="mode-selection">
        <label class="radio-option">
          <input type="radio" name="extraction-mode" value="quick" checked>
          <span class="radio-label">
            <strong>Quick</strong>
            <small>Grid data only - fast extraction</small>
          </span>
        </label>
        <label class="radio-option">
          <input type="radio" name="extraction-mode" value="detailed">
          <span class="radio-label">
            <strong>Detailed</strong>
            <small>Opens each task - includes checklists, notes</small>
          </span>
        </label>
      </div>
      <div class="button-group">
        <button id="btn-export" class="btn btn-primary">Extract Plan Data</button>
      </div>
      <div id="export-progress" class="progress hidden">
        <div class="progress-text">Extracting...</div>
        <div class="progress-bar-container">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <div id="progress-detail" class="progress-detail"></div>
      </div>
    </section>

    <section id="import-section" class="section">
      <h2>Import Tasks</h2>
      <p class="section-description">Create tasks from a CSV file</p>
      <div class="button-group">
        <button id="btn-import-csv" class="btn btn-secondary">Import from CSV</button>
      </div>
    </section>

    <section id="add-task-section" class="section">
      <h2>Add Task</h2>
      <div class="form-group">
        <label for="task-title">Task Title</label>
        <input type="text" id="task-title" placeholder="Enter task title...">
      </div>
      <div class="form-group">
        <label for="bucket-select">Bucket</label>
        <select id="bucket-select">
          <option value="">Select a bucket...</option>
        </select>
        <button id="btn-refresh-buckets" class="btn btn-small" title="Refresh buckets">&#8635;</button>
      </div>
      <div class="form-group">
        <label for="task-due-date">Due Date (optional)</label>
        <input type="date" id="task-due-date">
      </div>
      <div class="form-group">
        <label for="task-priority">Priority</label>
        <select id="task-priority">
          <option value="5">Medium (Default)</option>
          <option value="1">Urgent</option>
          <option value="3">Important</option>
          <option value="9">Low</option>
        </select>
      </div>
      <div class="button-group">
        <button id="btn-add-task" class="btn btn-secondary">Add Task</button>
      </div>
      <div id="add-task-result" class="result hidden"></div>
    </section>

    <section id="history-section" class="section">
      <h2>Recent Exports</h2>
      <div id="history-list" class="history-list">
        <p class="empty-state">No exports yet</p>
      </div>
      <button id="btn-view-results" class="btn btn-secondary">View Last Export</button>
    </section>

    <footer>
      <p>Navigate to Planner or To Do to extract data</p>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
